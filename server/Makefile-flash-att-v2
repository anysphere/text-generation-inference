flash_att_v2_commit := 4f285b354796fb17df8636485b9a04df3ebbb7dc

PYTHON_PATH := /opt/miniconda/bin/python
PIP_PATH := /opt/miniconda/bin/pip

flash-attention-v2:
    # Clone flash attention
	$(PIP_PATH) install packaging
	git clone https://github.com/HazyResearch/flash-attention.git flash-attention-v2

build-flash-attention-v2: flash-attention-v2
	cd flash-attention-v2 && git fetch && git checkout $(flash_att_v2_commit)
	cd flash-attention-v2 && $(PYTHON_PATH) setup.py build

install-flash-attention-v2: build-flash-attention-v2
	cd flash-attention-v2 && $(PYTHON_PATH) setup.py install
